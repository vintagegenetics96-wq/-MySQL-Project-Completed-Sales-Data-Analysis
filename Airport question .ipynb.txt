{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f0b71262-2345-41dd-a687-d415ff961de5",
   "metadata": {},
   "source": [
    "# Airline Data Analytics Case-study | SQLite + Python¶\n",
    "This project aims to address the challenges faced by a leading air transportation company through data analytics. The company is experiencing issues like stricter environmental regulations, higher flight taxes, increased labor costs, and rising fuel prices, which impact profitability and growth prospects. To ensure long-term sustainability and success, the company plans to analyze its database to increase aircraft occupancy rates and maximize average profit per seat.\n",
    "\n",
    "**Problem Statement**\n",
    "\n",
    "- The airline company aims to enhance aircraft occupancy rates and identify strategic opportunities to increase profitability per seat. The key challenges are as follows:\n",
    "\n",
    "- Stricter environmental regulations: These regulations raise operating costs and restrict expansion potential.\n",
    "- Higher flight taxes: Increased taxes raise the overall cost of flying, reducing demand.\n",
    "- Tight labor market resulting in increased labor costs: Scarcity of skilled workers leads to higher labor costs and increased turnover rates."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a2762cec-def2-4642-a38b-97540a7d471c",
   "metadata": {},
   "source": [
    "# Import"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "8ad9d828-37cb-4884-a41a-749bec21e438",
   "metadata": {},
   "outputs": [],
   "source": [
    "import sqlite3\n",
    "import seaborn as sns\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "b0885529-2406-4d68-b886-c9b7c8250ef1",
   "metadata": {},
   "outputs": [],
   "source": [
    "con=sqlite3.connect('travel.sqlite')\n",
    "cousor=con.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "293923ac-3f0d-43e9-9844-4598dc68013a",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select name from sqlite_master where type='table'\n",
    "'''\n",
    "table=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "e612d422-6d9c-4bae-a805-49bbc0906a43",
   "metadata": {},
   "outputs": [],
   "source": [
    "# table"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "99ddcb6f-d1db-4e21-801a-56b79eb97ff5",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from airports_data\n",
    "'''\n",
    "airports_data=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "4d06864d-48fc-4429-9760-389b75032d60",
   "metadata": {},
   "outputs": [],
   "source": [
    "# airports_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "baae6d8a-7f1a-456e-a217-59ff20b1a785",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from boarding_passes\n",
    "'''\n",
    "boarding_passes=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2f2f7cb9-3064-453a-8ab9-5c2c98f7c7e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "# boarding_passes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "78c6869c-11ea-4e49-96d4-184bc398ea03",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from bookings\n",
    "'''\n",
    "bookings=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "5f13d800-f765-4801-a765-d8d85360de31",
   "metadata": {},
   "outputs": [],
   "source": [
    "# bookings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "278a4ab5-9ef0-4465-b842-def92c38aa8f",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from flights \n",
    "'''\n",
    "flights=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "42d5c053-0b83-42c7-89c2-eb80783e580d",
   "metadata": {},
   "outputs": [],
   "source": [
    "# flights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "7aca3674-c5bc-4339-ba83-64c281f319b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from seats\n",
    "'''\n",
    "seats=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "bf128c56-9853-4f11-9633-e5340d6a5b9a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# seats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "858a7cd1-6a31-4e46-ac6c-636268312bdf",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from ticket_flights\n",
    "'''\n",
    "ticket_flights=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "9f451660-6a5a-42de-9420-bf93450f8288",
   "metadata": {},
   "outputs": [],
   "source": [
    "# ticket_flights"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "3dffc846-2277-4efc-bf3e-0f5b7fbefdd4",
   "metadata": {},
   "outputs": [],
   "source": [
    "query='''\n",
    "    select * from tickets\n",
    "'''\n",
    "tickets=pd.read_sql_query(query,con)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "3472029a-1337-4a9e-9a2f-18c68532ec45",
   "metadata": {},
   "outputs": [],
   "source": [
    "# tickets"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1267c81-6b85-42b3-bef2-d74d4ade1b30",
   "metadata": {},
   "source": [
    "# Cleaning"
   ]
  },
  {
   "cell_type": "raw",
   "id": "2317760a-16d1-40fc-824c-c14f2f42b52b",
   "metadata": {},
   "source": [
    "column = table['name'].values"
   ]
  },
  {
   "cell_type": "raw",
   "id": "67ae9f86-cf5a-4aaa-b247-c559e0abd47c",
   "metadata": {},
   "source": [
    "column = ['aircrafts_data', 'airports_data', 'boarding_passes', 'bookings','flights', 'seats', 'ticket_flights', 'tickets']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5362e909-b4bc-404b-aa82-36e623557d73",
   "metadata": {},
   "source": [
    "for i in column :\n",
    "    print(\"=\"*20)\n",
    "    print(i.shape)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ed584f0-02f2-4f39-82d4-8efaf9073dd9",
   "metadata": {},
   "source": [
    "for i in column :\n",
    "    print(\"=\"*120)\n",
    "    print(i.info)"
   ]
  },
  {
   "cell_type": "raw",
   "id": "a5ac995d-fb51-4ed2-96a4-b8290e865f1f",
   "metadata": {},
   "source": [
    "for i in column :\n",
    "    print(\"=\"*20)\n",
    "    print(i.isna().sum())"
   ]
  },
  {
   "cell_type": "raw",
   "id": "a9d0d86a-7706-477d-a6ab-7da63261b59c",
   "metadata": {},
   "source": [
    "for i in column :\n",
    "    print(\"=\"*5)\n",
    "    print(i.duplicated().sum())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3e1ea145-2bc1-4df8-b7ba-5eb1a0bdba83",
   "metadata": {},
   "source": [
    "# Basic Analysis\n",
    "- How many planes have more than 100 seats?\n",
    "- How the number of tickets booked and total amount earned changed with the time.\n",
    "- Calculate the average charges for each aircraft with different fare conditions.\n",
    "\n",
    "# Analyzing occupancy rate\n",
    "- \"For each aircraft, calculate the total revenue per year and the average revenue per ticket.\"\n",
    "- \"Calculate the average occupancy per aircraft.\"\n",
    "- \"Calculate by how much the total annual turnover could increase by giving all aircraft a 10% higher occupancy rate.\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "39f6c622-e1e6-41fc-900d-2799b98e9ade",
   "metadata": {},
   "source": [
    "# Q1 How many planes have more than 100 seats?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "7ee0dabc-d764-49d7-bd43-f0cf4243b448",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>aircraft_code</th>\n",
       "      <th>total_seats</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>319</td>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>320</td>\n",
       "      <td>140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>321</td>\n",
       "      <td>170</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>733</td>\n",
       "      <td>130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>763</td>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>773</td>\n",
       "      <td>402</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  aircraft_code  total_seats\n",
       "0           319          116\n",
       "1           320          140\n",
       "2           321          170\n",
       "3           733          130\n",
       "4           763          222\n",
       "5           773          402"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Q=\"select aircraft_code,count(*) as total_seats from seats group by aircraft_code having count(*)>100 \"\n",
    "no_seats=pd.read_sql_query(Q,con) \n",
    "no_seats"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "b371a882-fba7-408a-8e58-d504d7a54a1d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "aircraft_code\n",
       "319    116\n",
       "320    140\n",
       "321    170\n",
       "733    130\n",
       "763    222\n",
       "773    402\n",
       "CN1     12\n",
       "CR2     50\n",
       "SU9     97\n",
       "Name: aircraft_code, dtype: int64"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "seats.groupby('aircraft_code')['aircraft_code'].count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "ed967362-806c-4b68-a102-adb706e94ada",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>total_Seats</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>aircraft_code</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>319</th>\n",
       "      <td>116</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>320</th>\n",
       "      <td>140</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>321</th>\n",
       "      <td>170</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>733</th>\n",
       "      <td>130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>763</th>\n",
       "      <td>222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>773</th>\n",
       "      <td>402</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "               total_Seats\n",
       "aircraft_code             \n",
       "319                    116\n",
       "320                    140\n",
       "321                    170\n",
       "733                    130\n",
       "763                    222\n",
       "773                    402"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Data=seats.pivot_table(index=\"aircraft_code\",values='fare_conditions',aggfunc=\"count\")\n",
    "Data=Data.rename(columns ={\"fare_conditions\":\"total_Seats\"})\n",
    "Data[Data[\"total_Seats\"]>100]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "82b97106-cc11-4945-b645-829e0b73e695",
   "metadata": {},
   "source": [
    "# Q2 How the number of tickets booked and total amount earned changed with the time."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "560f1317-b7d8-4bde-a8ad-8d4bfe36a388",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 262788 entries, 0 to 262787\n",
      "Data columns (total 3 columns):\n",
      " #   Column        Non-Null Count   Dtype \n",
      "---  ------        --------------   ----- \n",
      " 0   book_ref      262788 non-null  object\n",
      " 1   book_date     262788 non-null  object\n",
      " 2   total_amount  262788 non-null  int64 \n",
      "dtypes: int64(1), object(2)\n",
      "memory usage: 6.0+ MB\n"
     ]
    }
   ],
   "source": [
    "bookings.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "3aa52003-4095-467e-b4c9-bb9e7f606f84",
   "metadata": {},
   "outputs": [],
   "source": [
    "bookings['book_date']=pd.to_datetime(bookings['book_date'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "a7255d9f-a473-4aaa-b296-4686f2369380",
   "metadata": {},
   "outputs": [],
   "source": [
    "bookings[\"date\"]=bookings['book_date'].dt.date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "40aaf0cb-0386-4088-9b39-b9fec4f148ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date\n",
       "2017-06-21       441900\n",
       "2017-06-22       775300\n",
       "2017-06-23      1822000\n",
       "2017-06-24      5977000\n",
       "2017-06-25     15305400\n",
       "2017-06-26     29049100\n",
       "2017-06-27     54339900\n",
       "2017-06-28     91256400\n",
       "2017-06-29    152484000\n",
       "2017-06-30    205910000\n",
       "2017-07-01    281864700\n",
       "2017-07-02    332231100\n",
       "2017-07-03    384108400\n",
       "2017-07-04    409175900\n",
       "2017-07-05    424680000\n",
       "2017-07-06    434393100\n",
       "2017-07-07    443575300\n",
       "2017-07-08    430814500\n",
       "2017-07-09    444432000\n",
       "2017-07-10    441434900\n",
       "2017-07-11    437876000\n",
       "2017-07-12    426721800\n",
       "2017-07-13    432826700\n",
       "2017-07-14    460449000\n",
       "2017-07-15    441120100\n",
       "2017-07-16    448014600\n",
       "2017-07-17    430686400\n",
       "2017-07-18    440378400\n",
       "2017-07-19    448547900\n",
       "2017-07-20    445062300\n",
       "2017-07-21    437084500\n",
       "2017-07-22    427789700\n",
       "2017-07-23    433387400\n",
       "2017-07-24    433862000\n",
       "2017-07-25    455336100\n",
       "2017-07-26    434484900\n",
       "2017-07-27    427743700\n",
       "2017-07-28    446519200\n",
       "2017-07-29    423439400\n",
       "2017-07-30    436956700\n",
       "2017-07-31    439255100\n",
       "2017-08-01    447861400\n",
       "2017-08-02    442331900\n",
       "2017-08-03    428452000\n",
       "2017-08-04    451766500\n",
       "2017-08-05    450449600\n",
       "2017-08-06    456387300\n",
       "2017-08-07    452158300\n",
       "2017-08-08    467666600\n",
       "2017-08-09    479377800\n",
       "2017-08-10    485604400\n",
       "2017-08-11    490795600\n",
       "2017-08-12    492638500\n",
       "2017-08-13    509633600\n",
       "2017-08-14    524600500\n",
       "2017-08-15    395644100\n",
       "Name: total_amount, dtype: int64"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "t_amount=bookings.groupby(\"date\")['total_amount'].sum()\n",
    "t_amount"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "45e378dd-46e6-4d9e-b3a7-e2c3667b84bf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "date\n",
       "2017-06-21       3\n",
       "2017-06-22       7\n",
       "2017-06-23      20\n",
       "2017-06-24      74\n",
       "2017-06-25     191\n",
       "2017-06-26     363\n",
       "2017-06-27     730\n",
       "2017-06-28    1213\n",
       "2017-06-29    1989\n",
       "2017-06-30    2713\n",
       "2017-07-01    3550\n",
       "2017-07-02    4200\n",
       "2017-07-03    4788\n",
       "2017-07-04    5111\n",
       "2017-07-05    5353\n",
       "2017-07-06    5535\n",
       "2017-07-07    5544\n",
       "2017-07-08    5460\n",
       "2017-07-09    5676\n",
       "2017-07-10    5571\n",
       "2017-07-11    5684\n",
       "2017-07-12    5501\n",
       "2017-07-13    5507\n",
       "2017-07-14    5695\n",
       "2017-07-15    5493\n",
       "2017-07-16    5700\n",
       "2017-07-17    5392\n",
       "2017-07-18    5578\n",
       "2017-07-19    5516\n",
       "2017-07-20    5484\n",
       "2017-07-21    5581\n",
       "2017-07-22    5467\n",
       "2017-07-23    5472\n",
       "2017-07-24    5514\n",
       "2017-07-25    5571\n",
       "2017-07-26    5595\n",
       "2017-07-27    5471\n",
       "2017-07-28    5586\n",
       "2017-07-29    5444\n",
       "2017-07-30    5547\n",
       "2017-07-31    5476\n",
       "2017-08-01    5559\n",
       "2017-08-02    5512\n",
       "2017-08-03    5554\n",
       "2017-08-04    5608\n",
       "2017-08-05    5746\n",
       "2017-08-06    5761\n",
       "2017-08-07    5665\n",
       "2017-08-08    5813\n",
       "2017-08-09    5937\n",
       "2017-08-10    6081\n",
       "2017-08-11    6184\n",
       "2017-08-12    6350\n",
       "2017-08-13    6531\n",
       "2017-08-14    6787\n",
       "2017-08-15    5335\n",
       "Name: total_amount, dtype: int64"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "T_count=bookings.groupby(\"date\")['total_amount'].count()\n",
    "T_count"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "294007f9-247a-4689-85ae-507c3d8c55a3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "book_date\n",
       "7    167062\n",
       "8     88423\n",
       "6      7303\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "month=bookings[\"book_date\"].dt.month\n",
    "month.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "f963dd01-4c68-4718-bcc8-977db2c98a18",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ticket_no</th>\n",
       "      <th>flight_id</th>\n",
       "      <th>fare_conditions</th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0005432159776</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       ticket_no  flight_id fare_conditions  amount\n",
       "0  0005432159776      30625        Business   42100"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ticket_flights.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "6f6045fb-3e9e-4933-885b-a411c12c0d63",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>flight_id</th>\n",
       "      <th>flight_no</th>\n",
       "      <th>scheduled_departure</th>\n",
       "      <th>scheduled_arrival</th>\n",
       "      <th>departure_airport</th>\n",
       "      <th>arrival_airport</th>\n",
       "      <th>status</th>\n",
       "      <th>aircraft_code</th>\n",
       "      <th>actual_departure</th>\n",
       "      <th>actual_arrival</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1185</td>\n",
       "      <td>PG0134</td>\n",
       "      <td>2017-09-10 09:50:00+03</td>\n",
       "      <td>2017-09-10 14:55:00+03</td>\n",
       "      <td>DME</td>\n",
       "      <td>BTK</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>319</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   flight_id flight_no     scheduled_departure       scheduled_arrival  \\\n",
       "0       1185    PG0134  2017-09-10 09:50:00+03  2017-09-10 14:55:00+03   \n",
       "\n",
       "  departure_airport arrival_airport     status aircraft_code actual_departure  \\\n",
       "0               DME             BTK  Scheduled           319               \\N   \n",
       "\n",
       "  actual_arrival  \n",
       "0             \\N  "
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "flights.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d64785b0-27f4-4d44-a8e4-f64225ef2f4b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ticket_no</th>\n",
       "      <th>flight_id</th>\n",
       "      <th>fare_conditions</th>\n",
       "      <th>amount</th>\n",
       "      <th>flight_id</th>\n",
       "      <th>flight_no</th>\n",
       "      <th>scheduled_departure</th>\n",
       "      <th>scheduled_arrival</th>\n",
       "      <th>departure_airport</th>\n",
       "      <th>arrival_airport</th>\n",
       "      <th>status</th>\n",
       "      <th>aircraft_code</th>\n",
       "      <th>actual_departure</th>\n",
       "      <th>actual_arrival</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0005432159776</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "      <td>30625</td>\n",
       "      <td>PG0013</td>\n",
       "      <td>2017-07-16 18:15:00+03</td>\n",
       "      <td>2017-07-16 20:00:00+03</td>\n",
       "      <td>AER</td>\n",
       "      <td>SVO</td>\n",
       "      <td>Arrived</td>\n",
       "      <td>773</td>\n",
       "      <td>2017-07-16 18:18:00+03</td>\n",
       "      <td>2017-07-16 20:04:00+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0005435212351</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "      <td>30625</td>\n",
       "      <td>PG0013</td>\n",
       "      <td>2017-07-16 18:15:00+03</td>\n",
       "      <td>2017-07-16 20:00:00+03</td>\n",
       "      <td>AER</td>\n",
       "      <td>SVO</td>\n",
       "      <td>Arrived</td>\n",
       "      <td>773</td>\n",
       "      <td>2017-07-16 18:18:00+03</td>\n",
       "      <td>2017-07-16 20:04:00+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0005435212386</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "      <td>30625</td>\n",
       "      <td>PG0013</td>\n",
       "      <td>2017-07-16 18:15:00+03</td>\n",
       "      <td>2017-07-16 20:00:00+03</td>\n",
       "      <td>AER</td>\n",
       "      <td>SVO</td>\n",
       "      <td>Arrived</td>\n",
       "      <td>773</td>\n",
       "      <td>2017-07-16 18:18:00+03</td>\n",
       "      <td>2017-07-16 20:04:00+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0005435212381</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "      <td>30625</td>\n",
       "      <td>PG0013</td>\n",
       "      <td>2017-07-16 18:15:00+03</td>\n",
       "      <td>2017-07-16 20:00:00+03</td>\n",
       "      <td>AER</td>\n",
       "      <td>SVO</td>\n",
       "      <td>Arrived</td>\n",
       "      <td>773</td>\n",
       "      <td>2017-07-16 18:18:00+03</td>\n",
       "      <td>2017-07-16 20:04:00+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0005432211370</td>\n",
       "      <td>30625</td>\n",
       "      <td>Business</td>\n",
       "      <td>42100</td>\n",
       "      <td>30625</td>\n",
       "      <td>PG0013</td>\n",
       "      <td>2017-07-16 18:15:00+03</td>\n",
       "      <td>2017-07-16 20:00:00+03</td>\n",
       "      <td>AER</td>\n",
       "      <td>SVO</td>\n",
       "      <td>Arrived</td>\n",
       "      <td>773</td>\n",
       "      <td>2017-07-16 18:18:00+03</td>\n",
       "      <td>2017-07-16 20:04:00+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1045721</th>\n",
       "      <td>0005435097522</td>\n",
       "      <td>32094</td>\n",
       "      <td>Economy</td>\n",
       "      <td>5200</td>\n",
       "      <td>32094</td>\n",
       "      <td>PG0708</td>\n",
       "      <td>2017-09-14 17:15:00+03</td>\n",
       "      <td>2017-09-14 18:00:00+03</td>\n",
       "      <td>SGC</td>\n",
       "      <td>OVS</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>733</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1045722</th>\n",
       "      <td>0005435097521</td>\n",
       "      <td>32094</td>\n",
       "      <td>Economy</td>\n",
       "      <td>5200</td>\n",
       "      <td>32094</td>\n",
       "      <td>PG0708</td>\n",
       "      <td>2017-09-14 17:15:00+03</td>\n",
       "      <td>2017-09-14 18:00:00+03</td>\n",
       "      <td>SGC</td>\n",
       "      <td>OVS</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>733</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1045723</th>\n",
       "      <td>0005435104384</td>\n",
       "      <td>32094</td>\n",
       "      <td>Economy</td>\n",
       "      <td>5200</td>\n",
       "      <td>32094</td>\n",
       "      <td>PG0708</td>\n",
       "      <td>2017-09-14 17:15:00+03</td>\n",
       "      <td>2017-09-14 18:00:00+03</td>\n",
       "      <td>SGC</td>\n",
       "      <td>OVS</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>733</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1045724</th>\n",
       "      <td>0005435104352</td>\n",
       "      <td>32094</td>\n",
       "      <td>Economy</td>\n",
       "      <td>5200</td>\n",
       "      <td>32094</td>\n",
       "      <td>PG0708</td>\n",
       "      <td>2017-09-14 17:15:00+03</td>\n",
       "      <td>2017-09-14 18:00:00+03</td>\n",
       "      <td>SGC</td>\n",
       "      <td>OVS</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>733</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1045725</th>\n",
       "      <td>0005435104389</td>\n",
       "      <td>32094</td>\n",
       "      <td>Economy</td>\n",
       "      <td>5200</td>\n",
       "      <td>32094</td>\n",
       "      <td>PG0708</td>\n",
       "      <td>2017-09-14 17:15:00+03</td>\n",
       "      <td>2017-09-14 18:00:00+03</td>\n",
       "      <td>SGC</td>\n",
       "      <td>OVS</td>\n",
       "      <td>Scheduled</td>\n",
       "      <td>733</td>\n",
       "      <td>\\N</td>\n",
       "      <td>\\N</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1045726 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             ticket_no  flight_id fare_conditions  amount  flight_id  \\\n",
       "0        0005432159776      30625        Business   42100      30625   \n",
       "1        0005435212351      30625        Business   42100      30625   \n",
       "2        0005435212386      30625        Business   42100      30625   \n",
       "3        0005435212381      30625        Business   42100      30625   \n",
       "4        0005432211370      30625        Business   42100      30625   \n",
       "...                ...        ...             ...     ...        ...   \n",
       "1045721  0005435097522      32094         Economy    5200      32094   \n",
       "1045722  0005435097521      32094         Economy    5200      32094   \n",
       "1045723  0005435104384      32094         Economy    5200      32094   \n",
       "1045724  0005435104352      32094         Economy    5200      32094   \n",
       "1045725  0005435104389      32094         Economy    5200      32094   \n",
       "\n",
       "        flight_no     scheduled_departure       scheduled_arrival  \\\n",
       "0          PG0013  2017-07-16 18:15:00+03  2017-07-16 20:00:00+03   \n",
       "1          PG0013  2017-07-16 18:15:00+03  2017-07-16 20:00:00+03   \n",
       "2          PG0013  2017-07-16 18:15:00+03  2017-07-16 20:00:00+03   \n",
       "3          PG0013  2017-07-16 18:15:00+03  2017-07-16 20:00:00+03   \n",
       "4          PG0013  2017-07-16 18:15:00+03  2017-07-16 20:00:00+03   \n",
       "...           ...                     ...                     ...   \n",
       "1045721    PG0708  2017-09-14 17:15:00+03  2017-09-14 18:00:00+03   \n",
       "1045722    PG0708  2017-09-14 17:15:00+03  2017-09-14 18:00:00+03   \n",
       "1045723    PG0708  2017-09-14 17:15:00+03  2017-09-14 18:00:00+03   \n",
       "1045724    PG0708  2017-09-14 17:15:00+03  2017-09-14 18:00:00+03   \n",
       "1045725    PG0708  2017-09-14 17:15:00+03  2017-09-14 18:00:00+03   \n",
       "\n",
       "        departure_airport arrival_airport     status aircraft_code  \\\n",
       "0                     AER             SVO    Arrived           773   \n",
       "1                     AER             SVO    Arrived           773   \n",
       "2                     AER             SVO    Arrived           773   \n",
       "3                     AER             SVO    Arrived           773   \n",
       "4                     AER             SVO    Arrived           773   \n",
       "...                   ...             ...        ...           ...   \n",
       "1045721               SGC             OVS  Scheduled           733   \n",
       "1045722               SGC             OVS  Scheduled           733   \n",
       "1045723               SGC             OVS  Scheduled           733   \n",
       "1045724               SGC             OVS  Scheduled           733   \n",
       "1045725               SGC             OVS  Scheduled           733   \n",
       "\n",
       "               actual_departure          actual_arrival  \n",
       "0        2017-07-16 18:18:00+03  2017-07-16 20:04:00+03  \n",
       "1        2017-07-16 18:18:00+03  2017-07-16 20:04:00+03  \n",
       "2        2017-07-16 18:18:00+03  2017-07-16 20:04:00+03  \n",
       "3        2017-07-16 18:18:00+03  2017-07-16 20:04:00+03  \n",
       "4        2017-07-16 18:18:00+03  2017-07-16 20:04:00+03  \n",
       "...                         ...                     ...  \n",
       "1045721                      \\N                      \\N  \n",
       "1045722                      \\N                      \\N  \n",
       "1045723                      \\N                      \\N  \n",
       "1045724                      \\N                      \\N  \n",
       "1045725                      \\N                      \\N  \n",
       "\n",
       "[1045726 rows x 14 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Q=\"select * from ticket_flights t inner join flights f on  t.flight_id=f.flight_id \"\n",
    "f=pd.read_sql_query(Q,con)\n",
    "f"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5f353997-d06e-4694-8504-7354339e83e6",
   "metadata": {},
   "source": [
    "# 3. Calculate the average charges for each aircraft with different fare conditions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "9c03fcb1-85c5-4527-8eda-788b44a38395",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>fare_conditions</th>\n",
       "      <th>aircraft_code</th>\n",
       "      <th>avg_amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Business</td>\n",
       "      <td>319</td>\n",
       "      <td>113550.557703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Business</td>\n",
       "      <td>321</td>\n",
       "      <td>34435.662664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Business</td>\n",
       "      <td>733</td>\n",
       "      <td>41865.626175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Business</td>\n",
       "      <td>763</td>\n",
       "      <td>82839.842866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Business</td>\n",
       "      <td>773</td>\n",
       "      <td>57779.909435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Business</td>\n",
       "      <td>SU9</td>\n",
       "      <td>33487.849829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Comfort</td>\n",
       "      <td>773</td>\n",
       "      <td>32740.552889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Economy</td>\n",
       "      <td>319</td>\n",
       "      <td>38311.402347</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Economy</td>\n",
       "      <td>321</td>\n",
       "      <td>11534.974764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Economy</td>\n",
       "      <td>733</td>\n",
       "      <td>13985.152000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Economy</td>\n",
       "      <td>763</td>\n",
       "      <td>27594.721829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Economy</td>\n",
       "      <td>773</td>\n",
       "      <td>19265.225693</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Economy</td>\n",
       "      <td>CN1</td>\n",
       "      <td>6568.552345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Economy</td>\n",
       "      <td>CR2</td>\n",
       "      <td>13207.661102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Economy</td>\n",
       "      <td>SU9</td>\n",
       "      <td>11220.183400</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   fare_conditions aircraft_code     avg_amount\n",
       "0         Business           319  113550.557703\n",
       "1         Business           321   34435.662664\n",
       "2         Business           733   41865.626175\n",
       "3         Business           763   82839.842866\n",
       "4         Business           773   57779.909435\n",
       "5         Business           SU9   33487.849829\n",
       "6          Comfort           773   32740.552889\n",
       "7          Economy           319   38311.402347\n",
       "8          Economy           321   11534.974764\n",
       "9          Economy           733   13985.152000\n",
       "10         Economy           763   27594.721829\n",
       "11         Economy           773   19265.225693\n",
       "12         Economy           CN1    6568.552345\n",
       "13         Economy           CR2   13207.661102\n",
       "14         Economy           SU9   11220.183400"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Q='''select fare_conditions,aircraft_code, avg(amount) avg_amount from ticket_flights t inner join flights f on  \n",
    "t.flight_id=f.flight_id group by fare_conditions,aircraft_code'''\n",
    "data =pd.read_sql_query(Q,con)\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "c229576e-2903-40a6-9bcf-36e4ed43211c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "fare_conditions  aircraft_code\n",
       "Business         319              113550.557703\n",
       "                 321               34435.662664\n",
       "                 733               41865.626175\n",
       "                 763               82839.842866\n",
       "                 773               57779.909435\n",
       "                 SU9               33487.849829\n",
       "Comfort          773               32740.552889\n",
       "Economy          319               38311.402347\n",
       "                 321               11534.974764\n",
       "                 733               13985.152000\n",
       "                 763               27594.721829\n",
       "                 773               19265.225693\n",
       "                 CN1                6568.552345\n",
       "                 CR2               13207.661102\n",
       "                 SU9               11220.183400\n",
       "Name: amount, dtype: float64"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f.groupby(['fare_conditions','aircraft_code'] )['amount'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "c45e1176-2687-4346-a27d-2e93d80a1766",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>amount</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>fare_conditions</th>\n",
       "      <th>aircraft_code</th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th rowspan=\"6\" valign=\"top\">Business</th>\n",
       "      <th>319</th>\n",
       "      <td>113550.557703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>321</th>\n",
       "      <td>34435.662664</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>733</th>\n",
       "      <td>41865.626175</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>763</th>\n",
       "      <td>82839.842866</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>773</th>\n",
       "      <td>57779.909435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SU9</th>\n",
       "      <td>33487.849829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Comfort</th>\n",
       "      <th>773</th>\n",
       "      <td>32740.552889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th rowspan=\"8\" valign=\"top\">Economy</th>\n",
       "      <th>319</th>\n",
       "      <td>38311.402347</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>321</th>\n",
       "      <td>11534.974764</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>733</th>\n",
       "      <td>13985.152000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>763</th>\n",
       "      <td>27594.721829</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>773</th>\n",
       "      <td>19265.225693</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CN1</th>\n",
       "      <td>6568.552345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>CR2</th>\n",
       "      <td>13207.661102</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>SU9</th>\n",
       "      <td>11220.183400</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      amount\n",
       "fare_conditions aircraft_code               \n",
       "Business        319            113550.557703\n",
       "                321             34435.662664\n",
       "                733             41865.626175\n",
       "                763             82839.842866\n",
       "                773             57779.909435\n",
       "                SU9             33487.849829\n",
       "Comfort         773             32740.552889\n",
       "Economy         319             38311.402347\n",
       "                321             11534.974764\n",
       "                733             13985.152000\n",
       "                763             27594.721829\n",
       "                773             19265.225693\n",
       "                CN1              6568.552345\n",
       "                CR2             13207.661102\n",
       "                SU9             11220.183400"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f.pivot_table(values='amount',\n",
    "    index=['fare_conditions','aircraft_code'],\n",
    "       aggfunc=\"mean\"  )"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
